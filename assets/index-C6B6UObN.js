import{r as o,j as s}from"./index-Btyp9ZzC.js";const d=()=>{const[e,n]=o.useState(null),[a,l]=o.useState(!1),[c,r]=o.useState("");return o.useEffect(()=>(l(window.matchMedia("(display-mode: standalone)").matches||navigator.standalone||document.referrer.includes("android-app://")),window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),n(t)}),()=>{window.removeEventListener("beforeinstallprompt",()=>{})}),[]),o.useEffect(()=>{if(e){const t=setTimeout(()=>{e.prompt(),e.userChoice.then(i=>{i.outcome==="accepted"?(r("PWA 安装成功！"),console.log("用户安装了PWA")):(r("自动安装失败，请手动安装。"),console.log("用户拒绝安装PWA")),n(null)})},3e3);return()=>clearTimeout(t)}},[e]),o.useEffect(()=>{"serviceWorker"in navigator&&"PushManager"in window&&navigator.serviceWorker.ready.then(i=>{i.showNotification("假数据推送",{body:"这是一个假数据推送通知示例。",icon:"/favicon.ico"})});const t=setInterval(()=>{"serviceWorker"in navigator&&"PushManager"in window&&navigator.serviceWorker.ready.then(i=>{i.showNotification("定时假数据推送",{body:`新消息：${new Date().toLocaleTimeString()}`,icon:"/favicon.ico"})})},5e3);return()=>clearInterval(t)},[]),o.useEffect(()=>{Notification.permission==="default"&&Notification.requestPermission().then(t=>{console.log(t==="granted"?"用户同意接收通知":"用户拒绝接收通知")})},[]),{isInStandaloneMode:a,installationMessage:c,promptToInstall:()=>e==null?void 0:e.prompt()}},f=()=>{const{isInStandaloneMode:e,installationMessage:n,promptToInstall:a}=d();return s.jsxs("div",{children:[s.jsx("h1",{children:"React PWA Demo"}),n&&s.jsx("p",{children:n}),!e&&n==="自动安装失败，请手动安装。"&&s.jsx("button",{onClick:a,children:"手动安装PWA"})]})};export{f as default};
