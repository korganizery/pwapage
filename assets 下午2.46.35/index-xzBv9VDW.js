import{r as c,m as $,w as _,R as d,j as p}from"./index-Btyp9ZzC.js";import{I as b,L as M}from"./index-BTD0eE24.js";import{u as L,b as N,a as P,w as O}from"./use-gesture-react.esm-C-lmFbFD.js";import{B as S}from"./button-B8cGWGo2.js";import"./traverse-react-node-QsKZ_XmT.js";function D(e,o){return e.reduce((n,a)=>Math.abs(n-o)<Math.abs(a-o)?n:a)}const l="adm-swipe-action",I={rightActions:[],leftActions:[],closeOnTouchOutside:!0,closeOnAction:!0,stopPropagation:[]},T=c.forwardRef((e,o)=>{const n=$(I,e),a=c.useRef(null),u=c.useRef(null),v=c.useRef(null);function x(t){const r=t.current;return r?r.offsetWidth:0}function y(){return x(u)}function k(){return x(v)}const[{x:m},h]=L(()=>({x:0,config:{tension:200,friction:30}}),[]),g=c.useRef(!1),C=c.useRef(null);function j(){var t;(t=C.current)===null||t===void 0||t.call(C),g.current=!1}const W=N(t=>{var r;if(C.current=t.cancel,!t.intentional||(t.down&&(g.current=!0),!g.current))return;const[i]=t.offset;if(t.last){const R=y(),A=k();let s=i+t.velocity[0]*t.direction[0]*50;i>0?s=Math.max(0,s):i<0?s=Math.min(0,s):s=0;const f=D([-A,0,R],s);h.start({x:f}),f!==0&&((r=e.onActionsReveal)===null||r===void 0||r.call(e,f>0?"left":"right")),window.setTimeout(()=>{g.current=!1})}else h.start({x:i,immediate:!0})},{from:()=>[m.get(),0],bounds:()=>{const t=y();return{left:-k(),right:t}},axis:"x",preventScroll:!0,pointer:{touch:!0},triggerAllEvents:!0});function w(){h.start({x:0}),j()}c.useImperativeHandle(o,()=>({show:(t="right")=>{var r;t==="right"?h.start({x:-k()}):t==="left"&&h.start({x:y()}),(r=e.onActionsReveal)===null||r===void 0||r.call(e,t)},close:w})),c.useEffect(()=>{if(!n.closeOnTouchOutside)return;function t(r){if(m.get()===0)return;const i=a.current;i&&!i.contains(r.target)&&w()}return document.addEventListener("touchstart",t),()=>{document.removeEventListener("touchstart",t)}},[n.closeOnTouchOutside]);function E(t){var r,i;const R=(r=t.color)!==null&&r!==void 0?r:"light";return d.createElement(S,{key:t.key,className:`${l}-action-button`,style:{"--background-color":(i=B[R])!==null&&i!==void 0?i:R},onClick:A=>{var s,f;n.closeOnAction&&w(),(s=t.onClick)===null||s===void 0||s.call(t,A),(f=n.onAction)===null||f===void 0||f.call(n,t,A)}},t.text)}return _(n,d.createElement("div",Object.assign({className:l},W(),{ref:a,onClickCapture:t=>{g.current&&(t.stopPropagation(),t.preventDefault())}}),d.createElement(P.div,{className:`${l}-track`,style:{x:m}},O(n.stopPropagation,d.createElement("div",{className:`${l}-actions ${l}-actions-left`,ref:u},n.leftActions.map(E))),d.createElement("div",{className:`${l}-content`,onClickCapture:t=>{m.goal!==0&&(t.preventDefault(),t.stopPropagation(),w())}},d.createElement(P.div,{style:{pointerEvents:m.to(t=>t!==0&&m.goal!==0?"none":"auto")}},n.children)),O(n.stopPropagation,d.createElement("div",{className:`${l}-actions ${l}-actions-right`,ref:v},n.rightActions.map(E))))))}),B={light:"var(--adm-color-light)",weak:"var(--adm-color-weak)",primary:"var(--adm-color-primary)",success:"var(--adm-color-success)",warning:"var(--adm-color-warning)",danger:"var(--adm-color-danger)"},X=()=>{const e="abcdefghijklmnopqrstuvwxyz";return e[Math.floor(Math.random()*e.length)]},q=e=>{let o="";for(let n=0;n<e;n++)o+=X();return o},z=(e,o)=>{const n=Math.floor(Math.random()*(o-e+1))+e;let a="";for(let u=0;u<n;u++)a+=q(Math.floor(Math.random()*6)+3)+" ";return a.trim()},H=(e,o)=>new Array(Math.floor(Math.random()*(o-e)+e)).fill("").map(()=>z(2,5)),F=65,G=Array(26).fill("").map((e,o)=>({title:String.fromCharCode(F+o),items:H(3,10)})),Y=()=>{const e=[{key:"pin",text:"置顶",color:"primary"}],o=[{key:"unsubscribe",text:"取消关注",color:"light"},{key:"mute",text:"免打扰",color:"warning"},{key:"delete",text:"删除",color:"danger"}];return p.jsx(b,{style:{width:"100vw"},children:G.map(n=>{const{title:a,items:u}=n;return p.jsx(b.Panel,{index:a,title:`标题${a}`,children:p.jsx(M,{children:u.map((v,x)=>p.jsx(T,{leftActions:e,rightActions:o,children:p.jsx(M.Item,{children:v})},x))})},`标题${a}`)})})};export{Y as default};
